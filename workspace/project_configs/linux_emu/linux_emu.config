
#1: 编译规则
include $(BUILD_DIR)/arch_config/x86_64.config
include $(COMMON_CONFIG_DIR)/common_configs.mk

#2: 编译控制
compile_enable_detail 		= n

#3: 链接
CLINK_FLAGS += -Wl,-T "$(PROJECT_DIR)/$(PROJECT)/$(PROJECT).ld"
CLINK_FLAGS += -Wl,--gc-sections
CLINK_FLAGS += -Wl,--cref
CLINK_FLAGS += -fdata-sections -ffunction-sections

CLINK_FLAGS += -pthread

# CLINK_FLAGS += -Wl,--wrap=atexit
# CLINK_FLAGS += -nostartfiles
# CLINK_FLAGS += -Wl,--nostdlib
# CLINK_FLAGS += -Wl,--print-gc-sections
# CLINK_FLAGS += -std=c99

#4: c文件编译
#！！使用hal库时要指定硬件型号
# CFLAGS += -DUSE_HAL_DRIVER
# CFLAGS += -DSTM32F103xB
CFLAGS += -Wall
CFLAGS += -ggdb
CFLAGS += -fdata-sections -ffunction-sections

CFLAGS += -pthread

# CFLAGS += -nostartfiles
# CFLAGS += -std=c99
# CFLAGS += -MMD -MP -MF "$(@:%.o=%.d)"

#5: 汇编文件
ASMFLAGS += -Wall
ASMFLAGS += -ggdb
ASMFLAGS += -fdata-sections -ffunction-sections
# ASMFLAGS += -mthumb
# ASMFLAGS += -mthumb-interwork
# ASMFLAGS += -nostartfiles

#6: 开发板
	CATOS_BOARD_STM32F103VET6_FIRE				=	n
	CATOS_BOARD_LINUX							=	y

#7: 指定部分模块的编译与否
#7.1: 内核模块
#CATOS
#bsp
#src
#	component
		CATOS_ENABLE_MEMRW						=	n
#	core
# 		idle_task
# 		init
# 		interrupt
# 		support
#test
	CATOS_ENABLE_TEST							=	y
	CATOS_TEST_CAT_STRING						=   n


#7.2: 第三方

#7.3: 应用模块
#user

#8: 根据配置在参数中添加宏定义
ifeq ($(CATOS_BOARD_STM32F103VET6_FIRE), y)
CFLAGS += -DCATOS_BOARD_IS_STM32F103VET6_FIRE
endif
ifeq ($(CATOS_BOARD_LINUX), y)
CFLAGS += -DCATOS_BOARD_IS_LINUX
endif




